<!DOCTYPE html>
<html>
<head>
<style>
@page {
    @left { content: none }
    size: A5
}

ins { color: green }

.bar {
    position: fixed;
    background: green;
    width: 2mm;
    left: -8mm
}
</style>
<script>
Prince.trackBoxes = true;
Prince.addEventListener("complete", function() {
    var xs = document.getElementsByTagName("ins");
    var pageBars = {};
    for (var i = 0; i < xs.length; ++i)
    {
        var ins = xs[i];
        var boxes = ins.getPrinceBoxes();
        var bars = [];

        for (var j = 0; j < boxes.length; ++j)
        {
            var box = boxes[j];

            if (box.type == "SPAN")
            {
                if (!bars.length || bars[bars.length-1].pageNum != box.pageNum)
                {
                    bars.push({pageNum: box.pageNum, y1: box.y, y2: box.y - box.h});
                }
                else
                {
                    bars[bars.length-1].y2 = box.y - box.h;
                }
            }
        }

        for (var j = 0; j < bars.length; ++j)
        {
            var bar = bars[j];
            var height = (bar.y1 - bar.y2).toFixed(2);
            var page = PDF.pages[bar.pageNum-1];
            var y = (page.y - bar.y1).toFixed(2);
            if (!pageBars[bar.pageNum])
            {
                pageBars[bar.pageNum] = [];
            }
            pageBars[bar.pageNum].push("<div class='bar' style='top: "+y+"pt; height: "+height+"pt'></div>");
        }
    }

    console.log("<style>");

    for (var i in pageBars)
    {
        console.log("@page:nth("+i+") { @left { content: flow(bars"+i+") } }");
    }

    console.log("</style>");
    console.log();

    for (var i in pageBars)
    {
        console.log("<div style='flow: static(bars"+i+")'>");
        console.log(pageBars[i].join("\n"));
        console.log("</div>");
        console.log();
    }
}, false);
</script>
</head>
<body>

<!-- this part is generated by script and must be inserted -->
<style>
@page:nth(1) { @left { content: flow(bars1) } }
@page:nth(2) { @left { content: flow(bars2) } }
</style>

<div style='flow: static(bars1)'>
<div class='bar' style='top: 43.76pt; height: 85.29pt'></div>
<div class='bar' style='top: 472.88pt; height: 13.29pt'></div>
</div>

<div style='flow: static(bars2)'>
<div class='bar' style='top: 0.56pt; height: 27.69pt'></div>
<div class='bar' style='top: 100.40pt; height: 99.69pt'></div>
</div>
<!-- end of generated part -->

<p>
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc suscipit, nunc
vel interdum lacinia, ante nulla placerat magna, vel varius ante arcu et sem.
Nunc lobortis dolor nec lacus commodo ullamcorper. Nullam a ipsum tellus.
<ins>Maecenas porta id metus et sagittis. In auctor, felis nec mattis maximus,
velit ante semper est, in placerat ex ex sed purus. Sed sed felis laoreet
tellus fermentum auctor. Donec lacinia facilisis porta. Nullam blandit
lobortis orci, vel blandit nulla tempus at. Lorem ipsum dolor sit amet,
consectetur adipiscing elit.</ins> Aliquam vestibulum eros egestas, consectetur
sapien ornare, aliquam erat. In posuere fermentum velit quis efficitur.
Maecenas varius blandit orci, eu euismod nisi ultricies in.
</p>
<p>
Curabitur facilisis et velit eu faucibus. Cras nisi nibh, vestibulum in
tincidunt ut, fermentum vitae tellus. Suspendisse lobortis mauris est, ut
finibus purus lacinia vel. Pellentesque ac efficitur lectus. Sed eu lacinia
erat. Sed sit amet ullamcorper nisl. Donec vulputate elementum augue, et
consequat massa tempus eget. Sed vehicula mauris vitae mi sagittis pulvinar.
Fusce faucibus blandit ornare. Duis sed purus vel orci ultrices dignissim.
</p>
<p>

Nunc quis cursus tortor. Cras ut lacus quis nisl dapibus lacinia. Suspendisse
tincidunt at enim sed blandit. Quisque varius, augue sit amet ullamcorper
hendrerit, mauris urna ullamcorper magna, sed posuere nisl erat eget metus.
Maecenas tristique interdum sollicitudin. Donec metus diam, aliquam eget neque
vel, hendrerit consequat nisi. Sed ipsum nibh, tristique ac lorem eu, commodo
posuere metus.
</p>
<p>

Maecenas in orci leo. Ut ultricies in augue sit amet dignissim. Proin
ultricies euismod ultricies. Suspendisse potenti. Suspendisse pretium
consequat ligula non placerat. Phasellus semper fermentum sodales. <ins>Sed
pellentesque, felis in tempor congue, magna leo viverra risus, vitae facilisis
enim leo nec metus. Proin id blandit velit.</ins> Nam nec hendrerit libero, sagittis
accumsan tortor. Interdum et malesuada fames ac ante ipsum primis in faucibus.
Curabitur elementum hendrerit mauris. Proin vel magna eu nisi viverra auctor.
Aenean viverra imperdiet sem at imperdiet.
</p>
<p>
<ins>Maecenas aliquam, neque eget suscipit viverra, est nulla condimentum elit, eu
bibendum lorem arcu vel dolor. Nullam ut erat nibh. Cras et tempor purus.
Phasellus interdum sem id malesuada luctus. Sed eget lacus eget arcu faucibus
elementum sit amet pulvinar urna. Cras pretium, nibh quis consequat consequat,
ligula nisl convallis urna, in dignissim ipsum orci in tellus. Nunc blandit
eleifend molestie.</ins> Aenean bibendum nec ante nec blandit. Curabitur porttitor,
enim in elementum rutrum, orci augue vulputate sapien, sed dictum sapien nibh
at sem. Praesent pulvinar, elit eget suscipit condimentum, eros sem pharetra
ex, eget elementum lacus leo vitae ligula. Aenean sodales augue mauris, a
tristique nisi vestibulum eu. Praesent tincidunt pharetra odio, sed faucibus
risus tempus sit amet. Nam est odio, ultricies ac semper ut, gravida non
massa. Donec facilisis lacus eget neque venenatis, ac sodales quam placerat.
Fusce tellus risus, ornare in ipsum in, accumsan interdum neque. Ut vestibulum
semper velit, eget consectetur mi volutpat vitae.
</p>
</body>
</html>
